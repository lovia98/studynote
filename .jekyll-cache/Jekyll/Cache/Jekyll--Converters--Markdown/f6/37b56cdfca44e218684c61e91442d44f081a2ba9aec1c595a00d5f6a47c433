I"ª!<p>Spring Cloud í™ˆí˜ì´ì§€ì— ë”°ë¥´ë©´, MSAì™€ ê°™ì€ ë¶„ì‚° ì‹œìŠ¤í…œì˜ ê·œëª¨ê°€ ì ì°¨ ì»¤ì§€ë©´ì„œ ì¤‘ê°„ì— ì¡°ì •í• 
ìˆ˜ ìˆëŠ” ë³„ë„ì˜ ì„œë¹„ìŠ¤ê°€ í•„ìš”í•˜ê³ , ì´ ì„œë¹„ìŠ¤ë¥¼ ì‰½ê²Œ êµ¬ì¶• í•  ìˆ˜ ìˆëŠ” í”„ë ˆì„ì›ì´ë¼ê³  ì†Œê°œ ë˜ê³  ìˆë‹¤.
(ì°¸ê³  ë§í¬ : <a href="http://projects.spring.io/spring-cloud/" target="_blank">http://projects.spring.io/spring-cloud/</a>)</p>

<p>ì¼ë‹¨ ë‚´ê°€ ì´í•´ ëœ Spring Cloudì˜ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ëŠ” Applicationì—ì„œ í•„ìš”í•œ ì„¤ì • ì •ë³´(dbì ‘ì† ì •ë³´, apië„ë©”ì¸ ì •ë³´ë“±..)ë¥¼
ë‹´ì€ propertiesë¥¼ ë°°í¬ ì—†ì´ ìˆ˜ì • ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>ë‹¤ë¥¸ ë¸”ë¡œê±°ë‹˜ì´ ì˜¬ë ¤ ë†“ì€ ì •ë³´ë¥¼ í† ëŒ€ë¡œ ë‚´ê°€ ë§Œë“  ì˜ˆì œë¥¼ ì •ë¦¬í•´ë³¸ë‹¤.
<span class="font14">
<br />( ì°¸ê³  ë§í¬ : <a href="http://blog.leekyoungil.com/?p=352">http://blog.leekyoungil.com/?p=352</a>
<br /><a href="http://jeroenbellen.com/manage-and-reload-spring-application-properties-on-the-fly">
http://jeroenbellen.com/manage-and-reload-spring-application-properties-on-the-fly</a>
<br /><a href="https://projects.spring.io/spring-cloud/spring-cloud.html#customizing-bootstrap-properties">https://projects.spring.io/spring-cloud/spring-cloud.html#customizing-bootstrap-properties</a></span> )</p>

<hr />

<h3 id="ê³µí†µ-config-properties-ë§Œë“¤ê¸°-githubì—-ìƒì„±">ê³µí†µ config properties ë§Œë“¤ê¸° (gitHubì— ìƒì„±)</h3>
<p><br /><span class="font14">* ìƒ˜í”Œ ì½”ë“œ : <a href="https://github.com/lovia98/spring-cloud-config" target="_blank">https://github.com/lovia98/spring-cloud-config</a></span>
<br />Â Â 2ê°œì˜ product, paymentì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ 2ê°œì˜ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤ê³  ê°€ì •í•˜ê³  ì•„ë˜ 2ê°œì˜ íŒŒì¼ì„
ë§Œë“ ë‹¤.
<br /><span class="font14"><bold>payment-service.yml</bold></span>
<br /><img src="/blog/assets/img/spring/spring_cloud_1.jpg" />
<br /><span class="font14"><bold>product-service.yml</bold> (profileë³„ë¡œ ë‚˜ëˆ„ì–´ì§„ ìƒíƒœ)</span>
<br /><img src="/blog/assets/img/spring/spring_cloud_2.jpg" /></p>

<hr />

<h3 id="config-server-ì„¤ì •">Config Server ì„¤ì •</h3>
<ol>
  <li>Cloud Config Server ë§Œë“¤ê¸° (Intellj, mavenê¸°ì¤€)
<br /><span class="font14">ì°¸ê³  ë§í¬ : <a href="https://github.com/lovia98/spring-cloud-example" target="_blank">https://github.com/lovia98/spring-cloud-example</a></span>
    <ul>
      <li>Spring boot project ìƒì„±
  <br /><img src="/blog/assets/img/spring/spring_cloud_3.jpg" /></li>
      <li>Dependencies ì—ì„œ <bold>Cloud Config &gt; config Server<bold>ì„ íƒ
  <br /><img src="/blog/assets/img/spring/spring_cloud_4.jpg" /></bold></bold></li>
      <li>Application.javaì— @EnableConfigServerì¶”ê°€
  <br /><img src="/blog/assets/img/spring/spring_cloud_5.jpg" /></li>
      <li>application.yml ì„¤ì •
  <br />Spring Cloud guideì—ì„œëŠ” bootstrap.ymlì„ ìƒì„±í•˜ë¼ê³  ê°€ì´ë“œ ë˜ì–´ ìˆëŠ”ë°, bootstrap.ymlíŒŒì¼ì€
  spring cloud applicationì—ì„œ application.ymlíŒŒì¼ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ì´ ëœë‹¤ê³  í•œë‹¤.
  <br /><span class="font14">spring.cloud.config.server.git.uri ì„¤ì •</span>
  <br /><img src="/blog/assets/img/spring/spring_cloud_6.jpg" />
  <br />êµ¬ê¸€ë§ì„ í•´ë³´ë‹ˆ configì„¤ì • propertiesëŠ” gitì´ ì•„ë‹ˆì—¬ë„ applicationë‚´ë¶€ì˜ class path, local file, http uri
  ëª¨ë‘ ì„¤ì •ì´ ê°€ëŠ¥ í•œê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.Â Â ìƒí™©(íšŒì‚¬ ë°©ì¹¨)ì— ë”°ë¼ ë§ì¶”ì–´ ì„¤ì •í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.</li>
    </ul>
  </li>
  <li>config server í™•ì¸
    <ul>
      <li>uri íŒ¨í„´ : {config-server-address}/{service-name}/{profiles}
  <br />githubì˜ payment-service.ymlì€ profileì´ ë‚˜ë‰˜ì–´ì ¸ ìˆì§€ ì•Šìœ¼ë¯€ë¡œ, {profiles}ë¶€ë¶„ì„ defaultë¡œ í•˜ì—¬ í˜¸ì¶œ í•œë‹¤.
  <br /><img src="/blog/assets/img/spring/spring_cloud_7.jpg" /></li>
      <li>product-serviceì˜ config ì •ë³´ (profileì„ êµ¬ë¶„í•˜ì—¬ì„œ dev, stgë¡œ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ë‹¤.)
  <br /><img src="/blog/assets/img/spring/spring_cloud_8.jpg" />
  <br /><img src="/blog/assets/img/spring/spring_cloud_9.jpg" /></li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="client-server-ì„¤ì •">Client Server ì„¤ì •</h3>
<ol>
  <li>Config Serverë¥¼ ì°¸ì¡°í•  clientì¸ ì¼ë°˜ì ì¸ Rest Api applicationì„ ìƒì„±í•œë‹¤.
    <ul>
      <li>pom.xmlì— spring-cloud-config-client, spring-boot-starter-actuator ë¥¼ ì¶”ê°€í•œë‹¤.
<br /><img src="/blog/assets/img/spring/spring_cloud_10.jpg" />
<br />spring-cloud-config-clientëŠ” config serverë¡œ ë¶€í„° configì •ë³´ë¥¼ ì–»ì–´ ì˜¤ê¸° ìœ„í•´ í•„ìš”í•˜ê³ ,
actuatorëŠ” ë°°í¬ì—†ì´ configì„¤ì • ë³€ê²½ì´ ì ìš©ë˜ê¸° ìœ„í•´ í•„ìš”í•˜ë‹¤. Â Â ìì„¸í•œ ê²ƒì€ ë’¤ì— config ìˆ˜ì • í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´
ì•Œê²Œ ë˜ë‹ˆ ìš°ì„  configì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„ì„ ë”°ë¼ê°€ ë³´ì~!</li>
      <li>bootstrap.yml(or application.yml) ìƒì„± ë° ì„¤ì •
<br /><img src="/blog/assets/img/spring/spring_cloud_11.jpg" />
<br />1) spring.application.name ì„ ì„¤ì •í•˜ë©´ í•´ë‹¹ ì„œë¹„ìŠ¤ëª…ì˜ configì •ë³´ê°€ ì ìš©ëœë‹¤.
<br />2) spring.management.security.enable = false ì•¡ì¸„ì—ì´í„° ë³´ì•ˆ ì²˜ë¦¬ falseë¡œ ì„¤ì •
<br />3) spring.endpoints.acurator.enabled = true ì•¡ì¸„ì—ì´í„° endpoints ì‚¬ìš©</li>
    </ul>
  </li>
</ol>

<ul>
  <li>
    <p>Rest Controller ìƒì„±
<br />Â 1) @Valueë¥¼ í†µí•œ config ì •ë³´ ê°€ì ¸ì˜¤ê¸°
<br /><img src="/blog/assets/img/spring/spring_cloud_12.jpg" />
<br />Â 2)@ConfigurationPropertiesë¥¼ í†µí•´ configì •ë³´ë¥¼ ê°ì²´ì— ë‹´ê¸°
<br /><img src="/blog/assets/img/spring/spring_cloud_14.jpg" />
<br /><img src="/blog/assets/img/spring/spring_cloud_15.jpg" /></p>
  </li>
  <li>
    <p>Client Application ì‹¤í–‰ì‹œ -Dspring.profiles.active=devë¡œ vm options ì¶”ê°€.
<br />applicationì˜ profileì„ dev ë¡œ ì„¤ì • í–ˆìœ¼ë‹ˆ deví™˜ê²½ì˜ ymlê°’ì„ ê°€ì ¸ì˜¤ê²Œ ëœë‹¤.
<br /><img src="/blog/assets/img/spring/spring_cloud_17.jpg" width="700" /></p>
  </li>
  <li>
    <p>@Valueì™€ Propertyê°ì²´ ì„¤ì •ì„ í†µí•œ configê°’ ëª¨ë‘ ì •ìƒì ìœ¼ë¡œ ë…¸ì¶œ ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</p>
  </li>
</ul>
<div class="row">
  <div class="4u 12u$(small)">
    <span class="font14">- @Valueë¥¼ í†µí•œ configê°’ í…ŒìŠ¤íŠ¸</span>
    <br /><img src="/blog/assets/img/spring/spring_cloud_13.jpg" />
  </div>
  <div class="6u 12u$(small)">
    <span class="font14">- ê°ì²´ë¥¼ í†µí•œ configê°’ í…ŒìŠ¤íŠ¸</span>
    <br /><img src="/blog/assets/img/spring/spring_cloud_16.jpg" />
  </div>
</div>

<hr />

<h3 id="ymlor-property-íŒŒì¼-ë³€ê²½ì‹œ-ìë™-ë°˜ì˜">yml(or property) íŒŒì¼ ë³€ê²½ì‹œ ìë™ ë°˜ì˜</h3>
<p><br />ì—¬ê¸°ê¹Œì§€ gitHubì— pushë˜ì–´ ìˆëŠ” ymlíŒŒì¼ì„ ì œê³µí•´ì£¼ëŠ” cloud config server ì„ ë§Œë“¤ê³  client serverì—ì„œ ì½ì–´ ì˜¤ëŠ” ë¶€ë¶„ì„
í™•ì¸ í•˜ì˜€ë‹¤. ê·¸ëŸ¼ ê¶ê·¹ì ìœ¼ë¡œ í™•ì¸í•´ ë³´ë ¤ê³  í•˜ëŠ” ë°°í¬ ì—†ëŠ” config íŒŒì¼ ìˆ˜ì •ì„ í…ŒìŠ¤íŠ¸ í•´ë³´ì.
<br /><span class="font14">( host.domainê°’ì„ <bold>item-dev-api1</bold>.myhost.comì—ì„œ <bold>item-dev-api</bold>.myhost.comë¡œ ë³€ê²½ )</span>
<br /><img src="/blog/assets/img/spring/spring_cloud_18.jpg" /></p>

<ul>
  <li>
    <p><span class="colorBlueLight">ê¸°ëŒ€í•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥´ê²Œ client Serverì—ì„œëŠ” ë³€ê²½ì´ ë°˜ì˜ë˜ì§€ ì•ŠëŠ”ë°,
<br />ì´ëŠ” @RefeshScopeë¥¼ ì ìš©í•œ ì˜ì—­ì—ì„œë§Œ buildì—†ì´ ì ìš©ë˜ê¸° ë•Œë¬¸ì´ë‹¤.</span></p>
  </li>
  <li>
    <p>í™•ì¸ì„ ìœ„í•´ ìƒˆë¡œìš´ @RefreshScopeë¥¼ ì ìš©í•œ Controllerë¥¼ ìƒì„±í•´ë³´ì.
<br /><img src="/blog/assets/img/spring/spring_cloud_19.jpg" /></p>
  </li>
  <li>
    <p><span class="colorBlueLight">@RefreshScopeê°€ ì ìš©ëœ controllerë¥¼ í˜¸ì¶œí•´ ë³´ì§€ë§Œ, ì—¬ì „íˆ ìë™ ë°˜ì˜ë˜ì§€ ì•Šë‹¤. ã…¡.ã…¡;;
<br /><img src="/blog/assets/img/spring/spring_cloud_20.jpg" />
</span>
<br />ì—¬ê¸°ì„œ client api serverë¥¼ ìƒì„±í• ë•Œ ì™œ actuator dependencyë¥¼ ì¶”ê°€í•´ì¤€ ì´ìœ ê°€ ë‚˜ì˜¤ëŠ”ë°,
boot applicationì„ ë°°í¬í•˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ buildë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” â€˜refreshâ€™ë¼ëŠ” endpointë¥¼ í†µí•´ì„œë§Œ ê°€ëŠ¥ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>
  </li>
  <li>
    <p>ì•„ë˜ì™€ ê°™ì´ <i>{client server address}/refresh</i> urië¥¼ POSTë¡œ í˜¸ì¶œí•˜ë©´,
<br /><img src="/blog/assets/img/spring/spring_cloud_21.jpg" />
<br />yml íŒŒì¼ì˜ ë³€ê²½ëœ ê°’ì´ host.domainì´ë¼ëŠ” ê²ƒì„ ì‘ë‹µìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë‹¤.</p>
  </li>
  <li>
    <p>@RefreshScopeê°€ ì ìš©ëœ controllerë¥¼ í˜¸ì¶œ í•˜ë©´ ê°’ì´ ë³€ê²½ëœ ê²ƒì„ í™•ì¸ í• ìˆ˜ ìˆë‹¤.
í•˜ì§€ë§Œ @RefreshScopeê°€ ì ìš©ë˜ì§€ ì•Šì€ controllerëŠ” ë°˜ì˜ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.
<br /><img src="/blog/assets/img/spring/spring_cloud_22.jpg" />
<br /><img src="/blog/assets/img/spring/spring_cloud_20.jpg" /></p>
  </li>
</ul>

<p>Spring CloudëŠ” ë°°í¬ì—†ëŠ” ë³€ê²½ì„ ì§€ì›í•´ ì£¼ê¸°ë„ í•˜ì§€ë§Œ ë‹¤ë¥¸ ê¸°ëŠ¥ë„ ì—¬ëŸ¬ê°œ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ëŠ”ë°, ì¢€ ë” ê³µë¶€ê°€ í•„ìš”í•  ê²ƒ ê°™ë‹¤.</p>

:ET